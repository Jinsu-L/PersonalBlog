# Requirements Document

## Introduction

이 문서는 기존 Next.js 기반 노션 블로그의 현재 구조와 디자인을 유지하면서 사용자 경험과 SEO를 향상시키는 6가지 핵심 기능을 자연스럽게 통합하는 요구사항을 정의합니다. 현재 코드베이스의 컴포넌트 구조, 스타일링 시스템(Emotion), 그리고 기존 설정들을 최대한 활용하여 댓글 시스템 개선, 읽기 시간 표시, RSS 피드, TOC, SEO 최적화, 시리즈 기능을 추가하는 것이 목표입니다.

## Requirements

### Requirement 1

**User Story:** As a 블로그 관리자, I want 기존에 구현된 Utterances 댓글 시스템이 올바르게 설정되고 작동하는지 확인하고 필요시 개선하기를, so that 방문자들이 포스트에 댓글을 남길 수 있다

#### Acceptance Criteria

1. WHEN 환경변수 NEXT_PUBLIC_UTTERANCES_REPO가 올바르게 설정될 때 THEN 시스템은 포스트 하단에 댓글 섹션을 표시해야 한다
2. WHEN 사용자가 개별 포스트 페이지에 접근 THEN 시스템은 기존 Utterances 컴포넌트를 통해 댓글 기능을 제공해야 한다
3. WHEN 댓글 섹션이 표시될 때 THEN 시스템은 현재 블로그의 다크/라이트 테마 설정을 자동으로 반영해야 한다
4. IF 환경변수가 설정되지 않았을 때 THEN 시스템은 댓글 섹션을 숨기고 에러를 발생시키지 않아야 한다

### Requirement 2

**User Story:** As a 블로그 방문자, I want 각 포스트의 예상 읽기 시간을 확인할 수 있기를, so that 포스트를 읽는데 필요한 시간을 미리 알고 계획할 수 있다

#### Acceptance Criteria

1. WHEN 사용자가 홈페이지의 포스트 목록을 볼 때 THEN 시스템은 기존 포스트 카드 레이아웃을 유지하면서 날짜 정보 옆에 "X분 읽기" 형태로 예상 읽기 시간을 표시해야 한다
2. WHEN 사용자가 개별 포스트 페이지에 접근 THEN 시스템은 기존 포스트 헤더 영역에서 제목과 메타데이터 근처에 예상 읽기 시간을 표시해야 한다
3. WHEN 읽기 시간이 표시될 때 THEN 시스템은 현재 사용 중인 타이포그래피와 색상 시스템을 따라야 한다
4. WHEN 시스템이 읽기 시간을 계산할 때 THEN 평균 읽기 속도 200단어/분을 기준으로 계산해야 한다
5. WHEN 포스트 내용이 한국어일 때 THEN 시스템은 한국어 특성을 고려하여 글자 수 기반으로 읽기 시간을 계산해야 한다
6. WHEN 계산된 읽기 시간이 1분 미만일 때 THEN 시스템은 "1분 미만 읽기"로 표시해야 한다
7. WHEN 포스트에 이미지나 코드 블록이 포함될 때 THEN 시스템은 추가 읽기 시간을 고려해야 한다
8. WHEN 읽기 시간을 계산할 때 THEN 시스템은 노션에서 가져온 포스트 데이터의 기존 구조를 활용해야 한다

### Requirement 3

**User Story:** As a 블로그 구독자, I want RSS 피드를 통해 새로운 포스트를 구독할 수 있기를, so that RSS 리더에서 새 글 알림을 받을 수 있다

#### Acceptance Criteria

1. WHEN 사용자가 /rss.xml 또는 /feed.xml 경로에 접근 THEN 시스템은 유효한 RSS 2.0 형식의 피드를 반환해야 한다
2. WHEN RSS 피드가 생성될 때 THEN 시스템은 최신 포스트 20개를 포함해야 한다
3. WHEN RSS 피드에 포스트 정보를 포함할 때 THEN 제목, 설명, 링크, 발행일, 작성자 정보를 포함해야 한다
4. WHEN 사용자가 블로그 상단 네비게이션을 볼 때 THEN 시스템은 기존 About 링크 옆에 RSS 아이콘 링크를 추가해야 한다
5. WHEN RSS 피드가 요청될 때 THEN 시스템은 적절한 Content-Type (application/rss+xml)을 설정해야 한다
6. WHEN 포스트 내용에 HTML이 포함될 때 THEN 시스템은 RSS 피드에서 안전하게 처리해야 한다
7. IF 노션 API에서 포스트를 가져올 수 없을 때 THEN 시스템은 빈 RSS 피드를 반환하고 에러를 발생시키지 않아야 한다

### Requirement 4

**User Story:** As a 블로그 방문자, I want 긴 포스트에서 목차(TOC)를 통해 원하는 섹션으로 빠르게 이동할 수 있기를, so that 포스트 내용을 효율적으로 탐색할 수 있다

#### Acceptance Criteria

1. WHEN 사용자가 개별 포스트 페이지에 접근하고 포스트에 헤딩(H1, H2, H3)이 3개 이상 있을 때 THEN 시스템은 포스트 상단 또는 사이드바에 목차를 표시해야 한다
2. WHEN 목차가 데스크톱에서 표시될 때 THEN 시스템은 고정 사이드바 형태로 표시해야 한다
3. WHEN 목차가 모바일에서 표시될 때 THEN 시스템은 점(dot) 형태의 미니멀한 인디케이터로 표시하고, 사용자가 터치하면 확장되어 전체 목차를 보여주는 형태로 구현해야 한다
4. IF 모바일용 점 형태 TOC 라이브러리를 찾을 수 없다면 THEN 시스템은 포스트 상단에만 목차를 표시하는 방식으로 구현해야 한다
3. WHEN 사용자가 목차의 항목을 클릭할 때 THEN 시스템은 해당 헤딩으로 부드럽게 스크롤해야 한다
4. WHEN 사용자가 포스트를 스크롤할 때 THEN 시스템은 현재 읽고 있는 섹션을 목차에서 하이라이트해야 한다
5. WHEN 목차가 렌더링될 때 THEN 시스템은 기존 Emotion 스타일링 시스템과 일관된 디자인을 적용해야 한다
6. WHEN 목차를 생성할 때 THEN 시스템은 노션에서 렌더링된 HTML 콘텐츠의 헤딩 태그를 파싱해야 한다
7. WHEN 포스트에 헤딩이 3개 미만일 때 THEN 시스템은 목차를 표시하지 않아야 한다
8. IF Next.js 생태계의 TOC 라이브러리를 사용할 수 있다면 THEN 시스템은 해당 라이브러리를 활용하여 구현해야 한다
9. WHEN TOC가 표시될 때 THEN 시스템은 "목록 보기"/"숨기기" 토글 버튼을 제공해야 한다
10. WHEN 사용자가 TOC "숨기기"를 선택할 때 THEN 시스템은 TOC를 최소화하거나 숨겨야 한다
11. WHEN 사용자가 TOC "목록 보기"를 선택할 때 THEN 시스템은 전체 목차를 표시해야 한다

### Requirement 5

**User Story:** As a 검색엔진 크롤러, I want 각 포스트의 메타데이터와 OpenGraph 정보를 정확히 파싱할 수 있기를, so that 검색 결과와 소셜 미디어 공유에서 포스트가 올바르게 표시될 수 있다

#### Acceptance Criteria

1. WHEN 검색엔진이 개별 포스트 페이지를 크롤링할 때 THEN 시스템은 포스트 제목, 설명, 썸네일, 작성일을 포함한 완전한 OpenGraph 메타태그를 제공해야 한다
2. WHEN 소셜 미디어에서 포스트 링크가 공유될 때 THEN 시스템은 적절한 og:title, og:description, og:image, og:url 정보를 제공해야 한다
3. WHEN 포스트에 썸네일이 없을 때 THEN 시스템은 기본 블로그 이미지 또는 자동 생성된 이미지를 OpenGraph 이미지로 사용해야 한다
4. WHEN 메타태그가 생성될 때 THEN 시스템은 기존 MetaConfig 컴포넌트를 확장하여 구현해야 한다
5. WHEN 포스트 설명이 너무 길 때 THEN 시스템은 적절한 길이(150-160자)로 자동 요약해야 한다
6. WHEN 검색엔진이 사이트를 크롤링할 때 THEN 시스템은 구조화된 데이터(JSON-LD)를 통해 Article 스키마를 제공해야 한다

### Requirement 6

**User Story:** As a 블로그 방문자, I want 연관된 포스트들을 시리즈로 묶어서 순차적으로 읽을 수 있기를, so that 특정 주제에 대한 연속된 내용을 체계적으로 학습할 수 있다

#### Acceptance Criteria

1. WHEN 노션 CMS에 "series" 컬럼이 추가되고 포스트에 시리즈 이름이 설정될 때 THEN 시스템은 해당 시리즈의 모든 포스트를 시간순으로 정렬해야 한다
2. WHEN 사용자가 시리즈에 속한 포스트를 읽을 때 THEN 시스템은 포스트 하단에 시리즈 네비게이션 섹션을 표시해야 한다
3. WHEN 시리즈 네비게이션이 표시될 때 THEN 시스템은 포스트들을 "1. 포스트 제목", "2. 포스트 제목" 형태로 번호와 함께 나열해야 한다
4. WHEN 현재 읽고 있는 포스트가 시리즈 목록에 표시될 때 THEN 시스템은 해당 항목을 다른 색상과 강조 스타일로 구분해야 한다
5. WHEN 시리즈에 포함된 포스트가 5개를 초과할 때 THEN 시스템은 페이지네이션을 통해 5개씩 표시하고 좌우 화살표로 탐색할 수 있게 해야 한다
6. WHEN 사용자가 시리즈의 다른 포스트를 클릭할 때 THEN 시스템은 해당 포스트로 이동해야 한다
7. WHEN 포스트가 시리즈에 속하지 않을 때 THEN 시스템은 시리즈 네비게이션 섹션을 표시하지 않아야 한다
8. WHEN 시리즈 네비게이션이 렌더링될 때 THEN 시스템은 기존 디자인 시스템과 일관된 스타일을 적용해야 한다
9. WHEN 시리즈 네비게이션이 표시될 때 THEN 시스템은 "목록 보기"/"숨기기" 토글 버튼을 제공해야 한다
10. WHEN 사용자가 "숨기기"를 선택할 때 THEN 시스템은 시리즈 이름만 표시하고 포스트 목록은 숨겨야 한다
11. WHEN 사용자가 "목록 보기"를 선택할 때 THEN 시스템은 전체 시리즈 포스트 목록을 표시해야 한다
9. WHEN 시리즈 데이터를 처리할 때 THEN 시스템은 기존 노션 API 클라이언트 구조를 확장하여 series 필드를 포함해야 한다